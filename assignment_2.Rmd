---
title: "Analysis of Population Dynamics by Age Groups and Regions"
author: "Bailey Dalton, Dhanya Dharshini Veeraraghavan, Vincent Currie"
date: "2024-11-20"
output: 
  bookdown::html_document2:
---
```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Load necessary libraries
library(dplyr)
library(ggplot2)
library(knitr)
library(tidyr)
library(plotly)
library(scales)
library(kableExtra)
library(bookdown)
```

## Data Preperation

```{r}
# Load the dataset
data <- read.csv("Data/population-young-working-elderly.csv")

```

# Group Section - Introduction 


# Research Questions - to asnwer in each analysis 

#### * Bailey Research Questions:
  * How has the population distribution across continents changed over the decades, particularly in terms of different age groups, and what are the potential causes and implications of these trends?
  
  * How has a region's economic development influenced population changes over time? Specifically, what are the population trends from 1950 to 2020 in low, medium, and high economic regions in each age group (youth, working and elderly)?"


#### * Vincent Research Questions:
  * 1. How does the gender gap in STEM (Science, Technology, Engineering, and Mathematics) education compare to other fields of study? 
  * 2.  What policies or factors have contributed to significant reductions in educational gender gaps?



#### * Dhanya Reserach Questoins: 
  * How has the population aged 65+ evolved globally over the past few decades, and what regions show the fastest growth in this age group?  
    - Aging populations are growing faster in developed countries due to higher life expectancy and declining fertility rates.
    - Certain developing countries may show a recent sharp increase, indicating early stages of demographic transition.
    - Regional differences highlight the need for targeted healthcare and social support systems.

  * What is the trend in the 0-14 age group population across different regions, and how does it reflect changes in birth rates or youth demographics?  
    - Declining trends in 0-14 populations in developed regions suggest falling birth rates, often associated with economic development and urbanization.
    - Regions with stable or growing 0-14 populations indicate continued high fertility rates, potentially creating future workforce surges.



# Bailey - Analysis 


```{r data preparation, eval = TRUE, echo = TRUE }
# read in data file
data1 <- read.csv("data/population-young-working-elderly-with-projections.csv")

# select only relevant variable columns 
data1 <- data1 %>% 
  # Rename varibles to simplify 
  rename(
    Population_65plus = Population...Sex..all...Age..65....Variant..estimates,
    Population_15to64 = Population...Sex..all...Age..15.64...Variant..estimates,
    Population_0to14 = Population...Sex..all...Age..0.14...Variant..estimates
  ) %>% 
  # Select relevant columns 
  select(
    Entity, 
    Code, 
    Year, 
    Population_65plus, 
    Population_15to64,
    Population_0to14
  ) %>% 
  # remove missing values 
  filter(
    !is.na(Population_65plus) & !is.na(Population_0to14) & !is.na(Population_15to64) & !is.na(Code)
  ) 
```

### Figure 1 - How has the population changed over the decades for each continent 

```{r ContinentPlot, echo = TRUE, eval = TRUE, fig.align='center', fig.cap="Figure 1: Column chart comparing population growth across continents from 1950 to 2020.", out.width= "80%", message = FALSE, warning = FALSE,}
Continent_data <- data1 %>% 
  filter(Entity %in% c("Africa (UN)", 
                       "Americas (UN)", 
                       "Asia (UN)", 
                       "Europe (UN)", 
                       "Northern America (UN)", 
                       "Australia")) %>% 
  mutate(Population = Population_65plus + Population_15to64 + Population_0to14)

ggplot(Continent_data, aes(x = Year, y = Population, color = Entity)) +
  geom_col() +
  facet_wrap(~ Entity, scales ="free_y") +
  theme(legend.position = "none") + 
  scale_y_continuous(labels = label_number(scale = 1e-6, suffix = "M")) + 
  labs(
    title = "Continental population growth from 1950-2023",
    x = "Year", 
    y = "Population",
  ) + 
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0.3)
    ) 
```

### Table 1 - continents population changes over decades 


```{r Continent-summary, echo = TRUE, eval = TRUE, message = FALSE, warning = FALSE}
# Create table from continent data 
continent_TabData <- Continent_data %>%
  # filter for years at the start of each decade 
  filter(Year %in% c(1950, 1960, 1970, 1980, 1990, 2000, 2010, 2020)) %>% 
  # group by country
  group_by(Entity) %>% 
  summarise(
    "Population 1950" = Population[Year == 1950],
    "Population 2020" = Population[Year == 2020],
    "Annual Growth Rate" = ((Population[Year == 2020] / Population[Year == 1950])^(1/70)-1)*100,
    "Percentage Population Aged 0-14 in 1950" = Population_0to14[Year == 1950] / Population[Year == 1950] * 100,
    "Percentage Population Aged 0-14 in 2020" = Population_0to14[Year == 2020] / Population[Year == 2020] * 100,
    "Percentage Population Aged 15-64 in 1950" = Population_15to64[Year == 1950] / Population[Year == 1950] * 100,
    "Percentage Population Aged 15-64 in 2020" = Population_15to64[Year == 2020] / Population[Year == 2020] * 100,
    "Percentage Population Aged 65+ in 1950" = Population_65plus[Year == 1950] / Population[Year == 1950] * 100,
    "Percentage Population Aged 65+ in 2020" = Population_65plus[Year == 2020] / Population[Year == 2020] * 100
            ) %>% 
  # format table values 
  mutate(
    # format population to million
    "Population 1950" = label_number(scale = 1e-6, suffix = "M", accuracy = 0.1)(`Population 1950`), 
    "Population 2020" = label_number(scale = 1e-6, suffix = "M", accuracy = 0.1)(`Population 2020`),
    # Format percentages to 2 decimal places with % symbol 
    "Annual Growth Rate" = paste0(round(`Annual Growth Rate`, 2), "%"),
    "Percentage Population Aged 0-14 in 1950" = paste0(round(`Percentage Population Aged 0-14 in 1950`, 2), "%"),
    "Percentage Population Aged 0-14 in 2020" = paste0(round(`Percentage Population Aged 0-14 in 2020`, 2), "%"), 
    "Percentage Population Aged 15-64 in 1950" = paste0(round(`Percentage Population Aged 15-64 in 1950`, 2), "%"),
    "Percentage Population Aged 15-64 in 2020" = paste0(round(`Percentage Population Aged 15-64 in 2020`, 2), "%"),
    "Percentage Population Aged 65+ in 1950" = paste0(round(`Percentage Population Aged 65+ in 1950`, 2), "%"),
    "Percentage Population Aged 65+ in 2020" = paste0(round(`Percentage Population Aged 65+ in 2020`, 2), "%")
  )

# Create and format summary table for continent data 
knitr::kable(continent_TabData, 
      caption = "Table 1: Continental population statistics, including populations in 1950 and 2020, growth rates, and age group percentages at both years."
      ) %>% 
  column_spec(1, bold = TRUE) %>%   # Bold first column 
  column_spec(1, width = "2in") %>%  # increase width of first column for spacing
  column_spec(2, width = "1in") %>%   # adjust width of columsn for values in table 
  kable_styling(bootstrap_options = c("striped", "hover"))   # format table for easy reading 
```

### Figure 2: 

```{r EcoP, echo = TRUE, eval = TRUE, fig.align='center', fig.cap="Figure 2: Area chart illustrating population growth trends across economic regions and age groups.", out.width= "80%", message = FALSE, warning = FALSE,}
# create data frame for population dev data (socioeco status regions) from data
Population_DevelopmentData <- data1 %>% 
  filter(Entity %in% c("Low-income countries", 
                       "Lower-middle-income countries", 
                       "Upper-middle-income countries", 
                       "High-income countries"
                       )) %>% 
  # rename age group columns for convenience 
  rename(
    "65+" = Population_65plus, 
    "15-64" = Population_15to64, 
    "0-14" = Population_0to14,
    "Socio_Economic_Status" = Entity
  ) %>% 
  # gather data to get it in the correct shape 
  gather(AgeGroup, Population, "65+", "15-64", "0-14") %>% 
  select(!Code) %>%
  mutate(Socio_Economic_Status = factor(Socio_Economic_Status, 
         levels = c("Low-income countries", 
                    "Lower-middle-income countries",
                    "Upper-middle-income countries", 
                    "High-income countries")))
  
# Create socio economic plot with formatting 
ggplot(Population_DevelopmentData, aes(x = Year, y = Population, fill = AgeGroup)) +
  geom_area(alpha = 0.7) + 
  facet_wrap(~ Socio_Economic_Status, nrow = 2) + 
  labs(title = "Population trends from 1950 to 2020 for varying economic regions", 
       x = "Year", 
       y = "Population", 
       fill = "Age Groups") +
  scale_fill_manual(values = c(
    "0-14" = "gold",
    "15-64" = "cyan",
    "65+" = "magenta"
  ))
```

### Table 2: 

```{r SocioEco, echo = TRUE, eval = TRUE, message = FALSE, warning = FALSE}
# Rectrieve socioEco from figure 2, data cleanup for table 
Economic_Popdata1 <- Population_DevelopmentData %>% 
  filter(Year %in% c(1950, 1985, 2020)) %>% 
  group_by(Year, Socio_Economic_Status, AgeGroup) %>% 
  summarise(Total_Population = sum(Population, na.rm = TRUE)) %>% 
  ungroup()

# Make the numerical population numbers wide 
Economic_Popdata_wide1 <- Economic_Popdata1 %>%
  spread(key = AgeGroup, value = Total_Population)%>% 
  # Add columns in Eco data for total population and percentage in each age group
  mutate(Total_Population = `0-14` + `15-64` + `65+`,
         "%_0-14" = `0-14` / Total_Population * 100,
         "%_15-64" = `15-64` / Total_Population * 100,
         "%_65+" = `65+` / Total_Population * 100
         ) 

# Select only the numerical population size data for each socioEco region
Economic_populations <- Economic_Popdata_wide1%>%
  select(
    Year, 
    Socio_Economic_Status, 
    `0-14`,
    `15-64`,
    `65+`
  ) %>% 
  # convert format of population for better readability in table 
  mutate(across(starts_with(c("0-14", "15-64", "65+")),
                ~ label_number(scale = 1e-6, suffix = "M", accuracy = 0.1)(.)
                ),
         Year = as.character(Year)
         ) 
# Select the percentage populations and perfoem same actions as above
Economic_pop_percentages <- Economic_Popdata_wide1 %>% 
  select(
    Year, Socio_Economic_Status, `%_0-14`, `%_15-64`, `%_65+`
  ) %>% 
  rename(
    `0-14` = `%_0-14`, `15-64`= `%_15-64`, `65+` = `%_65+`
  ) %>% 
  # Round the percentage to 2 decimal places
  mutate(
    `0-14` = round(`0-14`, 2),  
    `15-64` = round(`15-64`, 2), 
    `65+` = round(`65+`, 2)      
  ) %>% 
  # Convert to string and add "%" sign
  mutate(
    `0-14` = paste0(`0-14`, "%"),  
    `15-64` = paste0(`15-64`, "%"), 
    `65+` = paste0(`65+`, "%")      
  ) %>% 
  # Add % sign to Year column to differentiate percentages data from population num data 
  mutate(Year = paste0(Year, " (%)"))

Economic_Popdata_wide1 <- Economic_populations %>%
  pivot_wider(names_from = Socio_Economic_Status, values_from = c("0-14", "15-64", "65+")) %>% 
  select(
    Year, 
    "0-14_Low-income countries",
    "15-64_Low-income countries", 
    "65+_Low-income countries",
    "0-14_Lower-middle-income countries",
    "15-64_Lower-middle-income countries",
    "65+_Lower-middle-income countries",
    "0-14_Upper-middle-income countries", 
    "15-64_Upper-middle-income countries", 
    "65+_Upper-middle-income countries",
    "0-14_High-income countries",
    "15-64_High-income countries", 
    "65+_High-income countries",
  )

Eco_percentages_wide <- Economic_pop_percentages %>% 
  pivot_wider(names_from = Socio_Economic_Status, values_from = c("0-14", "15-64", "65+"))
  

# Join the two wider tables 
Economic_pop_data_combined <- bind_rows(Economic_Popdata_wide1, Eco_percentages_wide) %>% 
  arrange(Year)


Economic_pop_data_combined %>%
  kable(col.names = c("Year", 
                      "0-14", "15-64", "65+",
                      "0-14", "15-64", "65+",
                      "0-14", "15-64", "65+",
                      "0-14", "15-64", "65+"),
        caption = "Table 2: Population trends by age group and income region (1950, 1985, 2020).") %>%
  kable_styling(full_width = TRUE, position = "center") %>%
  column_spec(1, bold = TRUE) %>%  # Bold the Year column
  row_spec(seq(2, nrow(Economic_pop_data_combined), by = 2), background = "lightgray") %>% 
  add_header_above(c(" " = 1, 
                     "Low-income Countries" = 3, 
                     "Lower-middle-income Countries" = 3, 
                     "Upper-middle-income Countries" = 3, 
                     "High-income Countries" = 3))  
```


### Bailey - analysis 

* **How has population changed through the decades in each continent and what might be the causes for various population trends in the different continents?**

Figure \@ref(fig:ContinentPlot) shows population growth trends have varied significantly across continents from 1950 to 2020. Africa experienced the highest growth rate, with an annual growth rate of `r continent_TabData[continent_TabData$Entity == "Africa (UN)", "Annual Growth Rate"]`, while Europe saw the lowest at `r continent_TabData[continent_TabData$Entity == "Europe (UN)", "Annual Growth Rate"]` seen in \@ref(tab:Continent-summary). Africa’s population grew from `r continent_TabData[continent_TabData$Entity == "Africa (UN)", "Population 1950"]` to `r continent_TabData[continent_TabData$Entity == "Africa (UN)", "Population 2020"]` (1.38 billion), with a young demographic, as the percentage of those aged 65+ remained low. In contrast, Europe’s elderly population increased significantly, from `r continent_TabData[continent_TabData$Entity == "Europe (UN)", "Percentage Population Aged 65+ in 1950"]` in 1950 to `r continent_TabData[continent_TabData$Entity == "Europe (UN)", "Percentage Population Aged 65+ in 2020"]` in 2020, reflecting higher life expectancy and lower birth rates. Asia, while seeing moderate growth in its elderly population (up 5%), maintains a large working-age population. Across all continents, the percentage of those aged 0-14 declined, indicating lower birth rates. These trends are driven by factors like improved healthcare, lower fertility rates, and urbanization. These demographic shifts present challenges for economic growth, healthcare systems, and social services, highlighting the need for targeted policies addressing aging populations and youth employment (Lutz and KC, 2010). 
  
  * **How has a region's economic development influenced population changes over time? Specifically, what are the population trends from 1950 to 2020 in low, medium, and high economic regions in each age group (youth, working and elderly)?"**

The area chart depicted in \@ref(fig:EcoP) shows how population has changed over time for various socio-economic regions. from this we can see that areas of low-income have extremely small population growth in the age group 65+,  that areas of low income may have decreased life expectancy. \@ref(tab:SocioEco) shows that populations in low-income regions from 1950 to 2020, in the 65+ age group population decreased in percentage from `r Economic_pop_data_combined[Economic_pop_data_combined$Year == "1950 (%)", "0-14_Upper-middle-income countries"]` to `r Economic_pop_data_combined[Economic_pop_data_combined$Year == "2020 (%)", "0-14_Upper-middle-income countries"]` respectively while in regions of high-income the percentage of population aged 65+ has increased from `r Economic_pop_data_combined[Economic_pop_data_combined$Year == "1950 (%)", "65+_High-income countries"]` to `r Economic_pop_data_combined[Economic_pop_data_combined$Year == "2020 (%)", "65+_High-income countries"]`. This suggests that areas of higher socio-economic status elderly population is increasing while areas of lower economic status are decreasing, likely due to the discrepancy in educaiton levels and other socio-economic factors influencing life expectancy. 

The area chart in \@ref(fig:EcoP) and table \@ref(tab:SocioEco) show that low-income regions have experienced minimal growth in the 65+ age group, with its percentage slightly declining from `r Economic_pop_data_combined[Economic_pop_data_combined$Year == "1950 (%)", "0-14_Low-income countries"]` in 1950 to `r Economic_pop_data_combined[Economic_pop_data_combined$Year == "2020 (%)", "0-14_Low-income countries"]` in 2020. This likely reflects lower life expectancy and limited healthcare (Lutz and KC, 2010). In contrast, high-income regions saw the elderly population grow from `r Economic_pop_data_combined[Economic_pop_data_combined$Year == "1950 (%)", "65+_High-income countries"]` to  in 1950 to `r Economic_pop_data_combined[Economic_pop_data_combined$Year == "2020 (%)", "65+_High-income countries"]` in 2020, indicating better healthcare and longevity. Additionally, both regions saw declines in youth populations, while working-age populations have expanded, especially in high-income areas, highlighting broader demographic shifts driven by economic development.



# Vincent - Analysis 




# Dhanya Analysis 

#### Visualisation

#### Fig 1: Population Aged 65+ for Selected countries (1950-2020) - Dhanya

```{r}

# Define countries to highlight
highlight_countries <- c("United States", "China", "India", "Australia", "Japan")

# Filter data for highlighted countries
highlighted_data <- data %>% filter(Entity %in% highlight_countries)

# Create the stacked area chart
ggplot(highlighted_data, aes(x = Year, y = Population_65plus, fill = Entity)) +
  geom_area(alpha = 0.8) +  # Use geom_area for stacked chart
  labs(title = "Population Aged 65+ for Selected countries",
       x = "Year",
       y = "Population",
       fill = "Country") +
  theme_minimal() +
  scale_fill_manual(values = c(
    "United States" = "red", 
    "China" = "yellow", 
    "India" = "green", 
    "Australia" = "purple", 
    "Japan" = "orange"
  ))

```

#### Population Aged 0-14 for Selected Countries (1950-2020)

```{r}

# Define countries to include
selected_countries <- c("United States", "China", "India", "Australia", "Japan")

# Filter data for the selected countries
filtered_data <- data %>%
  filter(Entity %in% selected_countries) %>%
  group_by(Entity, Year) %>%
  summarise(Population_0to14 = sum(Population_0to14, na.rm = TRUE))

# Create the stacked area chart
ggplot(filtered_data, aes(x = Year, y = Population_0to14, fill = Entity)) +
  geom_area(alpha = 0.8) +  # Stacked area chart
  labs(title = "Population Aged 0-14 for Selected Countries (1950-2020)",
       x = "Year",
       y = "Population",
       fill = "Country") +
  theme_minimal() +
  scale_fill_manual(values = c(
    "United States" = "red", 
    "China" = "blue", 
    "India" = "green", 
    "Australia" = "purple", 
    "Japan" = "orange"
  ))

```

#### Tables

```{r}
# Calculate growth in the population aged 65+
growth <- data %>%
  group_by(Entity) %>%
  summarise(Start_1950 = first(Population_65plus),
            End_2023 = last(Population_65plus)) %>%
  mutate(Growth = End_2023 - Start_1950) %>%
  arrange(desc(Growth)) %>%
  head(5)

# Display the table
kable(growth, caption = "Table 1: Top 5 Countries with Highest Growth in Population Aged 65+")
```

```{r}
# Calculate growth in the population aged 0-14 for each country
growth <- data %>%
  group_by(Entity) %>%
  summarise(Start_1950 = first(Population_0to14),
            End_2023 = last(Population_0to14),
            Growth = End_2023 - Start_1950) %>%
  arrange(desc(Growth)) %>%
  head(5)

# Display the table
kable(growth, caption = "Table 2: Top 5 Countries with Highest Growth in Population Aged 0-14")
```

## Analysis


###### Figure 1: Population Aged 65+ for Selected Countries (1950-2020)

This chart highlights the rapid growth of elderly populations in selected countries. China shows the steepest increase due to improved healthcare and longer life expectancy (World Bank, 2023). Japan’s sharp rise post-1970 reflects its aging crisis caused by low fertility and high longevity, leading to challenges in sustaining healthcare and pensions (OECD, 2023). India’s slower growth suggests it remains in an earlier demographic stage, while the United States and Australia exhibit steady but less pronounced growth.

###### Figure 2: Population Aged 0-14 for Selected Countries (1950-2020)

India retains the largest 0-14 population due to high fertility rates (UNICEF, 2024). In contrast, China’s decline post-1970s aligns with its one-child policy (Pletcher, 2024). Developed nations like the United States, Japan, and Australia show consistent declines, reflecting lower birth rates and the challenges of maintaining a sustainable workforce in aging populations.

###### Table 1: Top 5 Countries with Highest Growth in Population Aged 65+

China, India, and Japan lead in growth, driven by rising life expectancies and large populations (UN DESA, 2023). Brazil and Russia follow, reflecting similar aging trends in emerging economies as they transition demographically.

###### Table 2: Top 5 Countries with Highest Growth in Population Aged 0-14

India, Nigeria, and Pakistan dominate, driven by high fertility rates in developing nations. Indonesia’s rise signals Southeast Asia’s growing youth population, while China’s moderated growth reflects earlier demographic trends during its high-fertility era.

# Group Section - Conclusion & References 

### Conclusion - Append this to final conclusion:

These trends illustrate aging challenges in developed nations and youth-driven opportunities in developing regions. Targeted policies in healthcare, education, and economic planning are essential to manage these demographic shifts effectively.

### References

World Bank. (2023). Population and demographic indicators. Retrieved from https://www.worldbank.org

OECD. (2023). The silver economy: Policies for an aging society. Retrieved from https://www.oecd.org

UNICEF. (2024). State of the world's children. Retrieved from https://www.unicef.org

Pletcher, K. (2024). China's one-child policy and its effects. Encyclopaedia Britannica. Retrieved from https://www.britannica.com

United Nations Department of Economic and Social Affairs. (2023). World population prospects. Retrieved from https://population.un.org 
Lutz, W. and KC, S (2010) 'Dimensions of global population projections: What do we know about future population trends and structures?'. Retrieved from https://royalsocietypublishing.org/doi/full/10.1098/rstb.2010.0133


